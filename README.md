## Just a basic notes as i go so i can spin back up if i need to

---
Authenticators:

```
hub:
  config:
    authenticator_class  #this defined which of the authenticators the hub will use
```

Basic LDAP 
```
hub:
  revisionHistoryLimit:
  config:
    JupyterHub:
      admin_access: true
      authenticator_class: ldapauthenticator.LDAPAuthenticator
    ## Ref: https://github.com/jupyterhub/ldapauthenticator
    LDAPAuthenticator:
      # LDAPS conn info
      server_address: SET_IN_CLI  # IP or FQDN only, no ldap(s)://
      server_port: 636
      use_ssl: true 
      ## Account look up settings
      valid_username_regex: ^[A-Za-z]*.[A-Za-z]*$  #good base for username characters
      bind_dn_template:
      - uid={username},cn=users,dc=acme,dc=com       #this is what jhub will use to make the query to ldap for the user info
      lookup_dn: true                                 #keeping this true for AD, sounds iffy for openldap or ipa
      lookup_dn_search_filter: ({login_attr}={login}) 
      user_search_base: cn=users,dc=acme,dc=com       #base search dn to find users
      allowed_groups:                                 #full DN group info to allow access a lsit of strings
      - "cn=grp-jhub-user,cn=groups,dc=acme,dc=com"
      - "cn=grp-jhub-admin,cn=groups,dc=acme,dc=com"
      admin_groups:
      - "cn=grp-jhub-admin,cn=groups,dc=acme,dc=com"   #similar to allowed_groups, but not exact - obviously
      user_attribute: uid                              #the user's uid (for openldap and ipa), of sAM-thing in AD
      # Bind account info
      lookup_dn_search_user: SET_IN_CLI #LDAP_BIND_UID         #when using the lookup_dn, some ldaps don't like anonymous binds
      lookup_dn_search_password: SET_IN_CLI #LDAP_BIND_PASSWD  #when using the lookup_dn, some ldaps don't like anonymous binds
      lookup_dn_user_dn_attribute: uid
```

OAuth - in this case Keycloak
```
hub:
  revisionHistoryLimit:
  config:
    JupyterHub:
      admin_access: true
      authenticator_class: generic-oauth
    GenericOAuthenticator:
      client_id: JHub            #generated by the admins as client creation
      client_secret: SET_IN_CLI  #OAUTH_SECRET this is generated within keycloak and the admins have to retrieve it
      oauth_callback_url: https://jhub.LAB_DOMAIN/hub/oauth_callback
      authorize_url: https://OAUTH_SERVER_FQDN/auth/realms/{REALM}/protocol/openid-connect/auth
      token_url: https://OAUTH_SERVER_FQDN/auth/realms/{REALM}/protocol/openid-connect/token
      userdata_url: https://OAUTH_SERVER_FQDN/auth/realms/{REALM}/protocol/openid-connect/userinfo
      login_service: keycloak     #whatever string you want the login button to have "Sign in with ...." 
      manage_groups: true         #this allows for the groups in the token to be used by jhub
      username_key: preferred_username  #this value is dependent on the OAuth provider, for keycloak the username is preferred_username
      userdata_params:
        state: state
      allowed_groups:
      - grp-jhub-user
      - grp-jhub-admin
      admin_groups:
      - grp-jhub-admin
```
Notes about OAuth
  - this is using the generic OAuth for jhub, if can be extended, but I have modified my keycloak to provide things:
    -  My client for jhub provides groups as a default scope
    -  My groups are based on an LDAP-based backend (pulls them into the realm and serves them out to the client auth)
